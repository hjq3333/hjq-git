

**无线端数据**



1.无线入店与承接

	**具体实现: 无线端的进店页面字段,进入店铺的访客数；相应商品的下单买家数，且是要算出一天里，七天里，一个月里分别的数据。**

	sql:
	
	SELECT 
	    entry_page AS 进店页面,
	    COUNT(DISTINCT visitor_id) AS 访客数,
	    COUNT(DISTINCT CASE WHEN is_paid = 1 THEN buyer_id END) AS 下单买家数,
	    -- 新增维度标识，用于区分不同查询结果
	    CASE 
	        WHEN dt = '传入的具体日期' THEN 'day'
	        WHEN dt BETWEEN DATE_SUB('传入的具体日期', INTERVAL 6 DAY) AND '传入的具体日期' THEN '7day'
	        WHEN dt BETWEEN DATE_SUB('传入的具体日期', INTERVAL 29 DAY) AND '传入的具体日期' THEN '30day'
	    END AS date_type
	FROM 
	    dws_traffic_wireless_entry_detail
	WHERE 
	    (dt = '传入的具体日期'
	    OR dt BETWEEN DATE_SUB('传入的具体日期', INTERVAL 6 DAY) AND '传入的具体日期'
	    OR dt BETWEEN DATE_SUB('传入的具体日期', INTERVAL 29 DAY) AND '传入的具体日期'
	    )
	    AND is_wireless = 1
	GROUP BY 
	    entry_page, date_type
	ORDER BY 
	    date_type, 访客数 DESC;

2.页面访问排行

    具体实现:
    店铺页:求出店铺内包含的首页、活动页等的浏览量和停留时长和访客量并按浏览量排序
    
            (
            SELECT 
                page_type,
                SUM(CASE WHEN page_type = '首页' THEN 1 ELSE 0 END) AS 首页浏览量,
                SUM(CASE WHEN page_type = '首页' THEN stay_duration ELSE 0 END) AS 首页停留时长,
                COUNT(DISTINCT CASE WHEN page_type = '首页' THEN visitor_id END) AS 首页访客量
            FROM 
                page_visit_log
            WHERE 
                page_type = '首页' AND is_wireless = 1
            GROUP BY 
                page_type
            )
            UNION ALL
            (
                SELECT
                    page_type,
                    SUM(CASE WHEN page_type = '活动页' THEN 1 ELSE 0 END) AS 活动页浏览量,
                    SUM(CASE WHEN page_type = '活动页' THEN stay_duration ELSE 0 END) AS 活动页停留时长,
                    COUNT(DISTINCT CASE WHEN page_type = '活动页' THEN visitor_id END) AS 活动页访客量
                FROM
                    page_visit_log
                WHERE
                    page_type = '活动页' AND is_wireless = 1
                GROUP BY
                    page_type
            )
            UNION ALL
            (
                SELECT
                    page_type,
                    SUM(CASE WHEN page_type = '分类页' THEN 1 ELSE 0 END) AS 分类页浏览量,
                    SUM(CASE WHEN page_type = '分类页' THEN stay_duration ELSE 0 END) AS 分类页停留时长,
                    COUNT(DISTINCT CASE WHEN page_type = '分类页' THEN visitor_id END) AS 分类页访客量
                FROM
                    page_visit_log
                WHERE
                    page_type = '分类页' AND is_wireless = 1
                GROUP BY
                    page_type
            )
            ORDER BY
                浏览量 DESC;
        
    商品详情页:商品基础详情页的浏览量和停留时长和访客量并按浏览量排序
        
            SELECT 
                page_type,
                SUM(CASE WHEN page_type = '商品基础详情页' THEN 1 ELSE 0 END) AS 浏览量,
                SUM(CASE WHEN page_type = '商品基础详情页' THEN stay_duration ELSE 0 END) AS 停留时长,
                COUNT(DISTINCT CASE WHEN page_type = '商品基础详情页' THEN visitor_id END) AS 访客量
            FROM
                page_visit_log
            WHERE
                page_type = '商品基础详情页' AND is_wireless = 1
            GROUP BY
                page_type
            ORDER BY
                浏览量 DESC;
         
    店铺其他页:除去上面两个，各种页面的浏览量和停留时长和访客量并按浏览量排序

        (
            SELECT 
                page_type,
                SUM(CASE WHEN page_type = '订阅页' THEN 1 ELSE 0 END) AS 订阅页浏览量,
                SUM(CASE WHEN page_type = '订阅页' THEN stay_duration ELSE 0 END) AS 订阅页停留时长,
                COUNT(DISTINCT CASE WHEN page_type = '订阅页' THEN visitor_id END) AS 订阅页访客量
            FROM 
                page_visit_log
            WHERE 
                page_type = '订阅页' AND is_wireless = 1
            GROUP BY 
                page_type
        )
        UNION ALL
        (
            SELECT
                page_type,
                SUM(CASE WHEN page_type = '直播页' THEN 1 ELSE 0 END) AS 直播页浏览量,
                SUM(CASE WHEN page_type = '直播页' THEN stay_duration ELSE 0 END) AS 直播页停留时长,
                COUNT(DISTINCT CASE WHEN page_type = '直播页' THEN visitor_id END) AS 直播页访客量
            FROM
                page_visit_log
            WHERE
                page_type = '直播页' AND is_wireless = 1
            GROUP BY
                page_type
        )
        ORDER BY
            浏览量 DESC;

3.店内路径